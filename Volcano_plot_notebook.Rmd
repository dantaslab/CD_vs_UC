---
title: "R Notebook"
output: html_notebook
---

```{r}
library(readxl)
library(dplyr)
library(ggplot2)

GWAS_cutoff <- read_xlsx("/Users/mark/Library/CloudStorage/Box-Box/Projects/Crohns/231019_cd_uc_linear.xlsx") %>% select(-c(`CD is 0`)) %>% mutate(cutoff_type=case_when(
  `Bonferroni` < 0.0000171 ~ 'Bonferonni Cutoff', 
  `FDR` < .05 ~ 'FDR Cutoff', 
  TRUE ~ 'Not Significant'
)) %>% mutate(scaled_pvalue = -log10(Pval))

volcano_plot <- GWAS_cutoff %>% ggplot(aes(x=`Beta`, y=`scaled_pvalue`, label=Name)) + geom_point(aes(color=cutoff_type), size=.8)+ scale_color_brewer(palette="Dark2")+geom_text(hjust=.5, vjust=-.5, size= 3.1)+ylab("-Log10 P")+theme_bw()
volcano_plot
ggsave("/Users/mark/Library/CloudStorage/Box-Box/Projects/Crohns/240524_volcano_v1_MG.png", dpi=900, height = 6, width = 10)
```



